# إعداد البريد الإلكتروني لنظام التأكيد

## نظرة عامة
تم إضافة نظام تأكيد البريد الإلكتروني للمستخدمين الجدد. يتطلب هذا النظام إعداد خدمة بريد إلكتروني لإرسال رسائل التأكيد.

## الإعداد المطلوب

### 1. إعداد Gmail (موصى به)
1. انتقل إلى حساب Gmail الخاص بك
2. فعل التحقق بخطوتين (2FA)
3. أنشئ كلمة مرور تطبيق:
   - انتقل إلى إعدادات Google Account
   - اختر "Security" من الجانب الأيسر
   - اختر "2-Step Verification"
   - في الأسفل، اختر "App passwords"
   - أدخل اسم التطبيق (مثل "TWM3 Server")
   - انسخ كلمة المرور المُولدة

### 2. تحديث متغيرات البيئة
في ملف `twm3-backend/.env`، حدث المتغيرات التالية:

```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
```

استبدل:
- `your-email@gmail.com` بعنوان بريدك الإلكتروني
- `your-app-password` بكلمة مرور التطبيق التي أنشأتها

### 3. بدائل أخرى للبريد الإلكتروني

#### استخدام SendGrid:
```env
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=your-sendgrid-api-key
```

#### استخدام Mailgun:
```env
SMTP_HOST=smtp.mailgun.org
SMTP_PORT=587
SMTP_USER=postmaster@your-domain.mailgun.org
SMTP_PASS=your-mailgun-password
```

## كيفية عمل النظام

1. **التسجيل**: عندما يسجل مستخدم جديد، يتم إنشاء رمز تحقق وإرسال بريد إلكتروني
2. **التأكيد**: يضغط المستخدم على الرابط في البريد الإلكتروني لتأكيد حسابه
3. **تسجيل الدخول**: لا يمكن تسجيل الدخول إلا بعد تأكيد الحساب
4. **إعادة الإرسال**: يمكن للمستخدم طلب إرسال بريد التحقق مرة أخرى

## الميزات المضافة

- ✅ التحقق من صحة البريد الإلكتروني في الواجهة الأمامية
- ✅ منع تسجيل الدخول ببريد إلكتروني غير صحيح
- ✅ إرسال بريد تأكيد تلقائي عند التسجيل
- ✅ صفحة تأكيد الحساب
- ✅ إمكانية إعادة إرسال بريد التحقق
- ✅ حماية من تسجيل الدخول للحسابات غير المؤكدة

## استكشاف الأخطاء

### خطأ في إرسال البريد
- تأكد من صحة إعدادات SMTP
- تأكد من أن كلمة مرور التطبيق صحيحة
- تحقق من إعدادات الأمان في حساب البريد

### عدم وصول البريد
- تحقق من مجلد السبام
- تأكد من صحة عنوان البريد المدخل
- جرب إعادة إرسال البريد

### مشاكل أخرى
- تأكد من تشغيل `npm install` في مجلد `twm3-backend`
- تحقق من console.log في الخادم للأخطاء